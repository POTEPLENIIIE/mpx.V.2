#!/bin/bash

echo "üîÑ –î–µ–ø–ª–æ–π –ø–æ—á–∞–≤—Å—è..."

# 1. –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–∞–ø–∫–∏ –ø—Ä–æ—î–∫—Ç—É
cd /root/mpx.V.2 || exit

# 2. –ë–µ–∫–µ–Ω–¥
echo "üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π –±–µ–∫–µ–Ω–¥—É..."
cd mpx-full-backend || exit
npm install

echo "üöÄ –ó–∞–ø—É—Å–∫ –±–µ–∫–µ–Ω–¥—É..."
pkill -f "node server.js"
nohup node server.js > backend.log 2>&1 &

# 3. –§—Ä–æ–Ω—Ç–µ–Ω–¥
echo "üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É..."
cd ../mpx-full-frontend || exit
npm install

echo "üõ† –ó–±—ñ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É..."
npm run build

echo "üìÇ –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É /var/www/mpx (–±–µ–∑ –≤–∏–¥–∞–ª–µ–Ω–Ω—è)..."
cp -r dist/mpx-full-frontend/* /var/www/mpx/

echo "‚úÖ –î–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
