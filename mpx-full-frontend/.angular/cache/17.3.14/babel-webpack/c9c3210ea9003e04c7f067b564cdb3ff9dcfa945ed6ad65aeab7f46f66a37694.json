{"ast":null,"code":"import { EventEmitter } from \"@angular/core\";\nimport { HttpHeaders } from \"@angular/common/http\";\nimport { CommonModule } from \"@angular/common\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nconst _c0 = [\"fileInput\"];\nfunction AvatarUploadComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ÉµÉµgetCurrentView();\n    i0.ÉµÉµelementStart(0, \"div\", 5)(1, \"div\");\n    i0.ÉµÉµelement(2, \"img\", 6);\n    i0.ÉµÉµelementStart(3, \"button\", 2);\n    i0.ÉµÉµlistener(\"click\", function AvatarUploadComponent_div_5_Template_button_click_3_listener() {\n      i0.ÉµÉµrestoreView(_r2);\n      const ctx_r2 = i0.ÉµÉµnextContext();\n      return i0.ÉµÉµresetView(ctx_r2.onUploadClicked());\n    });\n    i0.ÉµÉµtext(4, \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438\");\n    i0.ÉµÉµelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ÉµÉµnextContext();\n    i0.ÉµÉµadvance(2);\n    i0.ÉµÉµproperty(\"src\", ctx_r2.previewUrl, i0.ÉµÉµsanitizeUrl);\n  }\n}\nexport let AvatarUploadComponent = /*#__PURE__*/(() => {\n  class AvatarUploadComponent {\n    constructor(http) {\n      this.http = http;\n      this.avatarUpdated = new EventEmitter();\n      this.selectedFile = null;\n      this.previewUrl = null;\n    }\n    triggerFileInput() {\n      console.log(\"ðŸ“ Ð’Ñ–Ð´ÐºÑ€Ð¸Ñ‚Ð¾ Ð²Ð¸Ð±Ñ–Ñ€ Ñ„Ð°Ð¹Ð»Ñƒ\");\n      this.fileInput.nativeElement.click();\n    }\n    onFileSelected(event) {\n      const input = event.target;\n      if (input.files && input.files[0]) {\n        const file = input.files[0];\n        this.selectedFile = file;\n        const reader = new FileReader();\n        reader.onload = () => {\n          this.previewUrl = reader.result;\n          console.log(\"ðŸ“· ÐŸÑ€ÐµÐ²Ê¼ÑŽ Ð³Ð¾Ñ‚Ð¾Ð²Ðµ:\", this.previewUrl);\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n    onUploadClicked() {\n      console.log('â¬†ï¸ ÐšÐ½Ð¾Ð¿ÐºÐ° \"Ð—Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶Ð¸Ñ‚Ð¸\" Ð½Ð°Ñ‚Ð¸ÑÐ½ÑƒÑ‚Ð°!');\n      this.uploadAvatar();\n    }\n    uploadAvatar() {\n      if (!this.selectedFile) {\n        alert(\"â— Ð¤Ð°Ð¹Ð» Ð½Ðµ Ð¾Ð±Ñ€Ð°Ð½Ð¾\");\n        return;\n      }\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        alert(\"â— Ð¢Ð¾ÐºÐµÐ½ Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾\");\n        return;\n      }\n      const formData = new FormData();\n      formData.append(\"avatar\", this.selectedFile);\n      const headers = new HttpHeaders().set(\"Authorization\", `Bearer ${token}`);\n      this.http.post(\"http://localhost:4000/api/profile/avatar\", formData, {\n        headers\n      }).subscribe({\n        next: res => {\n          console.log(\"âœ… Ð£ÑÐ¿Ñ–Ñ…:\", res);\n          this.avatarUpdated.emit(res.avatar);\n          this.selectedFile = null;\n          this.previewUrl = null;\n        },\n        error: err => {\n          console.error(\"âŒ ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ–:\", err);\n        }\n      });\n    }\n    static {\n      this.Éµfac = function AvatarUploadComponent_Factory(t) {\n        return new (t || AvatarUploadComponent)(i0.ÉµÉµdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.Éµcmp = /*@__PURE__*/i0.ÉµÉµdefineComponent({\n        type: AvatarUploadComponent,\n        selectors: [[\"app-avatar-upload\"]],\n        viewQuery: function AvatarUploadComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ÉµÉµviewQuery(_c0, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ÉµÉµqueryRefresh(_t = i0.ÉµÉµloadQuery()) && (ctx.fileInput = _t.first);\n          }\n        },\n        outputs: {\n          avatarUpdated: \"avatarUpdated\"\n        },\n        standalone: true,\n        features: [i0.ÉµÉµStandaloneFeature],\n        decls: 6,\n        vars: 1,\n        consts: [[\"fileInput\", \"\"], [1, \"avatar-upload-container\"], [\"type\", \"button\", 3, \"click\"], [\"type\", \"file\", \"accept\", \".jpg,.jpeg\", \"hidden\", \"\", 3, \"change\"], [\"class\", \"preview-section\", 4, \"ngIf\"], [1, \"preview-section\"], [\"alt\", \"\\u041F\\u0440\\u0435\\u0432\\u02BC\\u044E\", 1, \"avatar-preview\", 3, \"src\"]],\n        template: function AvatarUploadComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ÉµÉµgetCurrentView();\n            i0.ÉµÉµelementStart(0, \"div\", 1)(1, \"button\", 2);\n            i0.ÉµÉµlistener(\"click\", function AvatarUploadComponent_Template_button_click_1_listener() {\n              i0.ÉµÉµrestoreView(_r1);\n              return i0.ÉµÉµresetView(ctx.triggerFileInput());\n            });\n            i0.ÉµÉµtext(2, \" \\u041E\\u0431\\u0440\\u0430\\u0442\\u0438 \\u0430\\u0432\\u0430\\u0442\\u0430\\u0440 (.jpg) \");\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµelementStart(3, \"input\", 3, 0);\n            i0.ÉµÉµlistener(\"change\", function AvatarUploadComponent_Template_input_change_3_listener($event) {\n              i0.ÉµÉµrestoreView(_r1);\n              return i0.ÉµÉµresetView(ctx.onFileSelected($event));\n            });\n            i0.ÉµÉµelementEnd();\n            i0.ÉµÉµtemplate(5, AvatarUploadComponent_div_5_Template, 5, 1, \"div\", 4);\n            i0.ÉµÉµelementEnd();\n          }\n          if (rf & 2) {\n            i0.ÉµÉµadvance(5);\n            i0.ÉµÉµproperty(\"ngIf\", ctx.previewUrl);\n          }\n        },\n        dependencies: [CommonModule, i2.NgIf],\n        styles: [\"@charset \\\"UTF-8\\\";.avatar-upload-container[_ngcontent-%COMP%]{position:relative;text-align:center;margin-top:20px}input[type=file][_ngcontent-%COMP%]{display:none}button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#22df58;color:#fff;font-weight:700;border:none;border-radius:8px;cursor:pointer;transition:.3s}button[_ngcontent-%COMP%]:hover{background-color:#1cb94b}.preview-section[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:1000;width:100vw;height:100vh;background-color:#000000a6;display:flex;justify-content:center;align-items:center;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.preview-section[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{background-color:#2a2b38;padding:30px;border-radius:16px;text-align:center;max-width:90%;box-shadow:0 0 30px #0009}.avatar-preview[_ngcontent-%COMP%]{width:160px;height:160px;border-radius:50%;object-fit:cover;border:3px solid #22df58;margin-bottom:20px;box-shadow:0 0 10px #22df58}.preview-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3f5fff;padding:10px 20px;border-radius:8px;font-weight:700}.preview-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2e48f3}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}\"]\n      });\n    }\n  }\n  return AvatarUploadComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}