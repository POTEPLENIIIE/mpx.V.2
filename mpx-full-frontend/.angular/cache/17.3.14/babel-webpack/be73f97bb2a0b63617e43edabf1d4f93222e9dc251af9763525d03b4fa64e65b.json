{"ast":null,"code":"import { EventEmitter } from \"@angular/core\";\nimport { HttpHeaders } from \"@angular/common/http\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nconst _c0 = [\"fileInput\"];\nfunction AvatarUploadComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.…µ…µgetCurrentView();\n    i0.…µ…µelementStart(0, \"div\", 5);\n    i0.…µ…µelement(1, \"img\", 6);\n    i0.…µ…µelementStart(2, \"button\", 7);\n    i0.…µ…µlistener(\"click\", function AvatarUploadComponent_div_5_Template_button_click_2_listener() {\n      i0.…µ…µrestoreView(_r2);\n      const ctx_r2 = i0.…µ…µnextContext();\n      return i0.…µ…µresetView(ctx_r2.uploadAvatar());\n    });\n    i0.…µ…µtext(3, \"\\u0417\\u0430\\u0432\\u0430\\u043D\\u0442\\u0430\\u0436\\u0438\\u0442\\u0438\");\n    i0.…µ…µelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.…µ…µnextContext();\n    i0.…µ…µadvance();\n    i0.…µ…µproperty(\"src\", ctx_r2.previewUrl, i0.…µ…µsanitizeUrl);\n  }\n}\nexport let AvatarUploadComponent = /*#__PURE__*/(() => {\n  class AvatarUploadComponent {\n    constructor(http) {\n      this.http = http;\n      this.selectedFile = null;\n      this.previewUrl = null;\n      this.avatarUpdated = new EventEmitter();\n    }\n    triggerFileInput() {\n      this.fileInput.nativeElement.click();\n    }\n    onFileSelected(event) {\n      const input = event.target;\n      // üëá –û—á–∏—â—É—î–º–æ value, —â–æ–± –ø–æ–¥—ñ—è change –≤—ñ–¥–±—É–ª–∞—Å—è –Ω–∞–≤—ñ—Ç—å –¥–ª—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ —Å–∞–º–æ–≥–æ —Ñ–∞–π–ª—É\n      input.value = \"\";\n      if (input.files && input.files.length > 0) {\n        const file = input.files[0];\n        if (!file.name.endsWith(\".jpg\") && !file.name.endsWith(\".jpeg\")) {\n          alert(\"‚ùå –î–æ–∑–≤–æ–ª–µ–Ω–æ –ª–∏—à–µ JPG-—Ñ–∞–π–ª–∏\");\n          return;\n        }\n        this.selectedFile = file;\n        const reader = new FileReader();\n        reader.onload = () => {\n          this.previewUrl = reader.result;\n          console.log(\"üì∑ –ü—Ä–µ–≤ º—é –≥–æ—Ç–æ–≤–µ:\", this.previewUrl);\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n    uploadAvatar() {\n      if (!this.selectedFile) return;\n      console.log(\"üöÄ –ù–∞–¥—Å–∏–ª–∞—î–º–æ –∞–≤–∞—Ç–∞—Ä...\");\n      console.log(\"üö® –ö–Ω–æ–ø–∫–∞ –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –Ω–∞—Ç–∏—Å–Ω—É—Ç–∞\");\n      const formData = new FormData();\n      formData.append(\"avatar\", this.selectedFile);\n      const token = localStorage.getItem(\"token\");\n      const headers = new HttpHeaders().set(\"Authorization\", `Bearer ${token}`);\n      this.http.post(\"http://localhost:4000/api/profile/avatar\", formData, {\n        headers\n      }).subscribe({\n        next: () => {\n          console.log(\"‚úÖ –ê–≤–∞—Ç–∞—Ä –æ–Ω–æ–≤–ª–µ–Ω–æ\");\n          this.avatarUpdated.emit();\n          this.selectedFile = null;\n          this.previewUrl = null;\n        },\n        error: err => {\n          console.error(\"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∞–≤–∞—Ç–∞—Ä–∞:\", err);\n          alert(\"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä.\");\n        }\n      });\n    }\n    static {\n      this.…µfac = function AvatarUploadComponent_Factory(t) {\n        return new (t || AvatarUploadComponent)(i0.…µ…µdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.…µcmp = /*@__PURE__*/i0.…µ…µdefineComponent({\n        type: AvatarUploadComponent,\n        selectors: [[\"app-avatar-upload\"]],\n        viewQuery: function AvatarUploadComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.…µ…µviewQuery(_c0, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.…µ…µqueryRefresh(_t = i0.…µ…µloadQuery()) && (ctx.fileInput = _t.first);\n          }\n        },\n        outputs: {\n          avatarUpdated: \"avatarUpdated\"\n        },\n        standalone: true,\n        features: [i0.…µ…µStandaloneFeature],\n        decls: 6,\n        vars: 1,\n        consts: [[\"fileInput\", \"\"], [1, \"avatar-upload-container\"], [1, \"file-input-label\", 3, \"click\"], [\"type\", \"file\", \"accept\", \".jpg,.jpeg\", 2, \"display\", \"none\", 3, \"change\"], [\"class\", \"preview-section\", 4, \"ngIf\"], [1, \"preview-section\"], [\"alt\", \"\\u041F\\u0440\\u0435\\u0432\\u02BC\\u044E\", 1, \"avatar-preview\", 3, \"src\"], [\"type\", \"button\", 3, \"click\"]],\n        template: function AvatarUploadComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.…µ…µgetCurrentView();\n            i0.…µ…µelementStart(0, \"div\", 1)(1, \"label\", 2);\n            i0.…µ…µlistener(\"click\", function AvatarUploadComponent_Template_label_click_1_listener() {\n              i0.…µ…µrestoreView(_r1);\n              return i0.…µ…µresetView(ctx.triggerFileInput());\n            });\n            i0.…µ…µtext(2, \" \\u041E\\u0431\\u0440\\u0430\\u0442\\u0438 \\u0430\\u0432\\u0430\\u0442\\u0430\\u0440 (.jpg) \");\n            i0.…µ…µelementStart(3, \"input\", 3, 0);\n            i0.…µ…µlistener(\"change\", function AvatarUploadComponent_Template_input_change_3_listener($event) {\n              i0.…µ…µrestoreView(_r1);\n              return i0.…µ…µresetView(ctx.onFileSelected($event));\n            });\n            i0.…µ…µelementEnd()();\n            i0.…µ…µtemplate(5, AvatarUploadComponent_div_5_Template, 4, 1, \"div\", 4);\n            i0.…µ…µelementEnd();\n          }\n          if (rf & 2) {\n            i0.…µ…µadvance(5);\n            i0.…µ…µproperty(\"ngIf\", ctx.previewUrl);\n          }\n        },\n        styles: [\".avatar-upload-container[_ngcontent-%COMP%]{margin-top:20px;text-align:center}.file-input-label[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#3f5fff;color:#fff;border-radius:8px;cursor:pointer;margin-bottom:10px}.preview-section[_ngcontent-%COMP%]{margin-top:15px}.avatar-preview[_ngcontent-%COMP%]{width:100px;height:100px;object-fit:cover;border-radius:50%;margin-bottom:10px;border:2px solid #22df58}button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#22df58;color:#fff;border:none;border-radius:6px;cursor:pointer}\"]\n      });\n    }\n  }\n  return AvatarUploadComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}